# -*- coding: utf-8 -*-
"""
Created on Thu May  6 22:15:29 2021

@author: subbu
"""
import numpy as np

R = 287
#Defining functions from Tanehill curve fits 
#Temperature as a function of Pressure and Density
def T_prho(p,rho,p0,rho0):
    X = np.log10(p/p0)
    Y = np.log10(rho/rho0)
    Z = X - Y
    pt = 0
    if -7 <= Y <= -4.5 and 0.25 < Z <= 0.95:
        g1 = 1.23718E-01        
        g2 = 1.08623E-02         
        g3 = 2.24239E-01         
        g4 = -8.24608E-02
        g5 = -1.17615E-03
        g6 = 1.18397
        g7 = -1.87566E-03
        g8 = 6.4852E-02
        g9 = -1.19155E-04
        g10 = -5.52634E-01
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
    elif -7 <= Y <= -4.5 and 0.95 < Z <= 1.40:
        g1 = -8.12952E00
        g2 = -8.28637E-01         
        g3 = 2.26904E01        
        g4 = 1.41132
        g5 = -2.98633E-02
        g6 = -1.91806E01
        g7 = 2.70066E-02
        g8 = -5.78875E-01
        g9 = -2.28103E-04
        g10 =5.6258
        g11 = -3.99845
        g12 = 2.26369E-01
        g13 = 2.52870
        g14 = -7.28448E-01
        g15 = 1.09769E-02
        g16 = 2.99238E00
        g17 = -1.83819E-02
        g18 = 3.9440E-01
        g19 = -1.51380E-04
        g20 = -2.04463
        g21 = -3.887015E01
        g22 = -2.908228E01
        g23 = 4.070557E01
        g24 = 2.682347E01
        pt = pt+1
    elif -7 <= Y <= -4.5 and 1.40 < Z <= 1.95:
        g1 = -1.98573        
        g2 = -1.67225         
        g3 = 3.76159E01         
        g4 = 2.10964E00
        g5 = -3.40174E-02
        g6 = -2.22215E01
        g7 = 2.31712E-02
        g8 = -6.44596E-01
        g9 = -9.80275E-05
        g10 = 4.40486
        g11 = -5.36809E00
        g12 = 2.41201E-01
        g13 = -1.25881
        g14 = -8.62744E-01
        g15 = -3.79774E-03
        g16 = 5.58609
        g17 = -7.81335E-03
        g18 = 3.78963E-01
        g19 = -3.80005E-04
        g20 = -1.81566
        g21 = 2.08E01
        g22 = -2.56E01
        g23 = 1
        g24 = 1.8E01
        pt = pt+1
    elif -7 <= Y <= -4.5 and 1.95< Z:
        g1 = -2.33271E01        
        g2 = -1.89958E00         
        g3 = 3.21440E01         
        g4 = 1.68622E00
        g5 = -4.42123E-02
        g6 = -1.36845E01
        g7 = 2.82629E-02
        g8 = -3.40976E-01
        g9 = 6.63272E-04
        g10 = 2.04466E00
        g11 = 8.35474
        g12 = 1.171347
        g13 = -1.60715E01
        g14 = -1.63139
        g15 = 4.14641E-02
        g16 = 8.70275
        g17 = -2.30068E-02
        g18 = 3.60966E-01
        g19 = 1.53246E-05
        g20 = -1.46166
        g21 = 1.115884
        g22 = -6.452606
        g23 = -5.337863E01
        g24 = 2.026986
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 0.25 < Z <= 0.95:
        g1 = 2.03910E-02
        g2 = 7.67310E-03         
        g3 = 8.48581E-01         
        g4 = -2.93086E-02
        g5 = 8.40269E-04
        g6 = 2.67251E-01
        g7 = -1.47701E-03
        g8 = 2.37262E-02
        g9 = 3.13687E-05
        g10 = -1.41973E-01
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 0.95 < Z <= 1.45:
        g1 = -5.12404
        g2 = -2.8474E-01         
        g3 = 1.54532E01         
        g4 = 4.52475E-01
        g5 = -1.22881E-02
        g6 = -1.35181E-02
        g7 = 8.56845E-03
        g8 = -1.68725E-01
        g9 = -3.25256E-04
        g10 = 4.18451
        g11 = 7.52564
        g12 = 8.35238E-01
        g13 = -1.95558E01
        g14 = -1.23393E00
        g15 = 3.34510E-02
        g16 = 1.171779E01
        g17 = -2.34269E-02
        g18 = 4.54628E-01
        g19 = 4.81788E-04
        g20 = -5.09936
        g21 = 6.148441E01
        g22 = -1.828123E01
        g23 = -5.468755E01
        g24 = 1.5625E01
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 1.45 < Z <= 2.05:
        g1 = -1.23779E01
        g2 = -1.14728         
        g3 = 2.41382E01        
        g4 = 1.38957E00
        g5 = -3.63693E-02
        g6 = -1.42844E01
        g7 = 2.24265E-02
        g8 = -4.06553E-01
        g9 = -3.23888E-04
        g10 = 2.8762
        g11 = 4.40782
        g12 = 1.33046
        g13 = -1.15405E01
        g14 = -1.59892
        g15 = 5.30580E-02
        g16 = 8.57309
        g17 = -3.10376E-02
        g18 = 4.71274E-01
        g19 = 4.77650E-04
        g20 = -1.96233E00
        g21 = 1.4075E02
        g22 = -6.49992
        g23 = -7.75E01
        g24 = 5
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 2.05 < Z:
        g1 = -1.27244E01
        g2 = -1.66684E00         
        g3 = 1.72708E01         
        g4 = 1.45307
        g5 = -3.64515E-02
        g6 = -6.97208
        g7 = 1.90463E-02
        g8 = -3.04323E-01
        g9 = 4.80787E-04
        g10 = 9.67524E-01
        g11 = 7.71330
        g12 = 5.0834E-01
        g13 = -9.8211E00
        g14 = -4.49138E-01
        g15 = -9.41787E-04
        g16 = 4.16530E00
        g17 = -2.40293E-03
        g18 = 9.63923E-02
        g19 = -8.2845E-04
        g20 = -5.88807E-01
        g21 = -1.092654E03
        g22 = -3.05312E02
        g23 = 4.656243E02
        g24 = 1.312498E02
        pt = pt+1
        
    elif -0.5 <= Y <= 3.0 and 0.25 < Z <= 1.00:
        g1 = -1.54141E-03
        g2 = 6.58337E-04        
        g3 = 9.82201E-01         
        g4 = -3.85028E-03
        g5 = 1.23111E-04
        g6 = 3.77441E-02
        g7 = -4.08210E-04
        g8 = 4.56963E-03
        g9 = 2.13592E-05
        g10 = -2.35172E-02
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 

        pt = pt+1    
        
    elif -0.5<= Y <= 3.0 and 1.00 < Z <= 1.45:
        g1 = 8.06492E-01
        g2 = 9.91293E-02         
        g3 = -1.70742E00         
        g4 = -2.28264E-01
        g5 = 5.03500E-03
        g6 = 3.02351
        g7 = -6.13927E-03
        g8 = 1.31574E-01
        g9 = 1.69824E-04
        g10 = -1.12755
        g11 = -1.17930E-01
        g12 = -2.12207E-01
        g13 = 1.36524E00
        g14 = 4.05886E-01
        g15 = -1.88260E-02
        g16 = -2.10926E00
        g17 = 1.65486E-02
        g18 = -1.89881E-01
        g19 = -5.1140E-04
        g20 = 8.79806E-01
        g21 = 1.959604E02
        g22 = -4.269391E01
        g23 = -1.734931E02
        g24 = 3.762898E01
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 1.45 < Z :
        g1 = -1.66249E00
        g2 = -8.91113E-02         
        g3 = 4.11648E00        
        g4 = 8.78093E-02
        g5 = -3.09742E-03
        g6 = -1.84445E00
        g7 = 1.99879E-03
        g8 = -7.50324E-03
        g9 = 6.85472E-05
        g10 = 3.05784E-01
        g11 = 1.11555E01
        g12 = 1.3210
        g13 = -1.71236E01
        g14 = -1.2919E00
        g15 = 6.28124E-02
        g16 = 8.63804
        g17 = -3.07949E-02
        g18 = 3.07809E-01
        g19 = 1.57743E-03
        g20 = -1.42634E00
        g21 = 1.330611E02
        g22 = 8.979635
        g23 = -7.265298E01
        g24 = -2.449009
        pt = pt+1 
    if pt == 0 :
            return p/(rho*R)
    A = round(g11 + g12*Y + g13*Z + g14*Y*Z + g15*Y**2 + g16*Z**2 + g17*Y**2*Z + g18*Y*Z**2 + g19*Y**3 + g20*Z**3,4)
    B = round(1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ),5)
    ans = g1 + g2*Y + g3*Z + g4*Y*Z + g5*Y**2 + g6*Z**2 + g7*Y**2*Z + g8*Y*Z**2 + g9*Y**3 + g10*Z**3 + (A/B)   
    return T0*10**ans

#Pressure as a function of internal energy and density
def p_erho(e,rho,T0,rho0):
    Y = np.log10(rho/rho0)
    Z = np.log10(e/(R*T0))
    pt = 0
    if -7 <= Y <= -4.5 and  Z <= 0.65:
        g1 = 1.3965       
        g2 = 0         
        g3 = 0         
        g4 = 0
        g5 = 0
        g6 = 0
        g7 = 0
        g8 = 0
        g9 = 0
        g10 = 0
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -7 <= Y <= -4.5 and 0.65 <  Z <= 1.50:
        g1 = 1.52792       
        g2 = -1.26953E-02   
        g3 = -6.135154E-01
        g4 = -5.08262E-02
        g5 = -5.49384E-03
        g6 = 6.31835E-01
        g7 = 4.75120E-05
        g8 = 3.34012E-02
        g9 = -3.18468E-04
        g10 = -2.19921E-01
        g11 = -4.96286E01
        g12 = -1.17932E01
        g13 = 6.91027E01
        g14 = 4.40405E01
        g15 = 5.09249E00
        g16 = 1.37308E01
        g17 = -1.40326
        g18 = -1.78726E01
        g19 = 2.08988E-01
        g20 = -1.86943E01
        g21 = 24.60452E00
        g22 = -2.0
        g23 = -2.93022E01
        g24 = 0 
        pt = pt+1
        B = (1 - np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -7 <= Y <= -4.5 and  1.50 < Z <= 2.20:
        g1 = -1.70333E01
        g2 = -5.08545E-01
        g3 = 2.46299E01
        g4 = 4.45617E-01
        g5 = -8.95298E-03
        g6 = -1.10204E01
        g7 = 2.29618E-03
        g8 = -9.89186E-04
        g9 = -2.89186E-04
        g10 = 1.62903
        g11 = 1.86797E01
        g12 = 5.19662E-01
        g13 = -2.41338E01
        g14 = -4.34837E-01
        g15 = 9.16089E-03
        g16 = 1.02035E01
        g17 = -1.52082E-03
        g18 = 9.70762E-02
        g19 = 3.46482E-04
        g20 = -1.3946E00
        g21 = -1.42762E02
        g22 = -1.647088
        g23 = 7.660312E01
        g24 = 8.259346E-01
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -7 <= Y <= -4.5 and 2.20 <  Z <= 3.05:
        g1 = 2.24374       
        g2 = 1.03073E-01   
        g3 = -5.32238E-01
        g4 = -5.59852E-02
        g5 = 3.56484E-03
        g6 = -4.80156E-02
        g7 = -1.01359E-04
        g8 = 1.06794E-02
        g9 = 1.59127E-04
        g10 = 3.66035E-02
        g11 = -5.70378E00
        g12 = -3.10056E-01
        g13 = 5.01094
        g14 = 1.80411E-01
        g15 = -9.4936E-03
        g16 = -1.40331
        g17 = 1.94839E-03
        g18 = -2.79718E-02
        g19 = -2.24908E-04
        g20 = 1.20278E-01
        g21 = 1.139755E02
        g22 = -4.985467E00
        g23 = -4.223833E01
        g24 = 2.009706E00
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -7 <= Y <= -4.5 and  3.05 < Z <= 3.40:
        g1 = -0.20807E02       
        g2 = 0.40197E00
        g3 = 0.22591E02
        g4 = -0.25660
        g5 = -0.95833E-03
        g6 = -0.77174E01
        g7 = 0.23966E-02
        g8 = 0.4606E-01
        g9 = 0.33671E-03
        g10 = 0.878E00
        g11 = -0.21737E03
        g12 = -0.46927E01
        g13 = 0.18101E03
        g14 = 0.26621E01
        g15 = -0.34759E-01
        g16 = -0.50019E02
        g17 = 0.64681E-02
        g18 = -0.38381E00
        g19 = -0.70391E-03
        g20 = 0.45795E01
        g21 = 0.4544373E03
        g22 = 0.1250133E02
        g23 = -0.1376001E03
        g24 = -0.364174E01
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -7 <= Y <= -4.5 and 3.40 < Z:
        g1 = -5.22951E01
        g2 = -4.00011E-01
        g3 = 4.56439E01
        g4 = 2.24484E-01
        g5 = -3.73775E-03
        g6 = -1.29756E01
        g7 = 2.43161E-03
        g8 = -2.79517E-02
        g9 = 2.24755E-04
        g10 =1.22998
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -4.5<= Y <= -0.5 and  Z <= 0.65:
        g1 = 1.398       
        g2 = 0         
        g3 = 0         
        g4 = 0
        g5 = 0
        g6 = 0
        g7 = 0
        g8 = 0
        g9 = 0
        g10 = 0
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -4.5<= Y <= -0.5 and  0.65 < Z <= 1.50:
        g1 = 1.39123       
        g2 = -4.08321E-03   
        g3 = 1.42545E-02
        g4 = 1.41769E-02
        g5 = 2.57225E-04
        g6 = 6.2555E-02
        g7 = 6.52912E-04
        g8 = -7.83637E-03
        g9 = 8.46912E-05
        g10 = -9.78720E-02
        g11 = 5.80955E00
        g12 = -1.82302E-01
        g13 = -9.62396E00
        g14 = 1.79619E-01
        g15 = -2.30518E-02
        g16 = 5.27047
        g17 = 1.1872E-02
        g18 = -3.65507E-02
        g19 = -3.35499E-04
        g20 = -9.19897E-01
        g21 = 14.2
        g22 = 0
        g23 = -10
        g24 = 0 
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -4.5<= Y <= -0.5 and  1.50 < Z <= 2.22:
        g1 =  -1.20784E00    
        g2 = -2.57909E-01
        g3 = 5.02307E00
        g4 = 2.87201E-01
        g5 = -9.95577E-03
        g6 = -3.20619
        g7 = 5.23524E-03
        g8 = -7.50405E-02
        g9 = -1.45574E-04
        g10 = 6.51564E-01
        g11 = -6.62841E00
        g12 = 2.7112E-02
        g13 = 7.30762E00
        g14 = -7.6823E-02
        g15 = 7.19421E-03
        g16 = -2.33161
        g17 = -3.62463E-03
        g18 = 3.04767E-02
        g19 = 1.62777E-04
        g20 = 1.66856E-01
        g21 = 1.255324E02
        g22 = 2.015335
        g23 = -6.390747E01
        g24 = -6.51525E-01
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -4.5<= Y <= -0.5 and  2.22 < Z <= 2.95:
        g1 = -2.26460       
        g2 = -7.82263E-02         
        g3 = 4.90497
        g4 = 7.18096E-02
        g5 = -3.06443E-03
        g6 = -2.24750
        g7 = 1.74209E-03
        g8 = -1.31641E-02
        g9 = 2.84214E-05
        g10 = 3.33658E-01
        g11 = -1.47904E01
        g12 = -1.76627E-01
        g13 = 1.35036E01
        g14 = 8.77280E-02
        g15 = -2.13327E-03
        g16 = -3.95372E00
        g17 = 7.15487E-04
        g18 = -8.96151E-03
        g19 = 7.30928E-05
        g20 = 3.63229E-01
        g21 = 1.788542E02
        g22 = 6.317894E00
        g23 = -6.756741E01
        g24 = -2.46006
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -4.5<= Y <= -0.5 and  2.95 < Z:
        g1 = -1.66904E01
        g2 = -2.58318E-01
        g3 = 1.7835E01
        g4 = 1.54898E-01
        g5 = -9.71263E-03
        g6 = -5.94108
        g7 = 3.97740E-03
        g8 = -2.01335E-02
        g9 = 9.04300E-05
        g10 = 6.60432E-01
        g11 = 8.54690E01
        g12 = 1.17554E01
        g13 = -7.21760E01
        g14 = -7.15723
        g15 = -4.16145E-02
        g16 = 2.01758E01
        g17 = 1.38147E-02
        g18 = 1.08990
        g19 = 5.45184E-04
        g20 = -1.86438
        g21 = 2.883262E02
        g22 = 1.248536E01
        g23 = -8.816985E01
        g24 = -3.720309E00
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -0.5<= Y <= 3.0 and  Z <= 0.65:
        g1 = 1.3988       
        g2 = 0         
        g3 = 0         
        g4 = 0
        g5 = 0
        g6 = 0
        g7 = 0
        g8 = 0
        g9 = 0
        g10 = 0
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -0.5<= Y <= 3.0 and  0.65 < Z <= 1.70:
        g1 = 1.37062       
        g2 = 1.29673E-02  
        g3 = 1.11418E-01
        g4 = -3.26912E-02
        g5 = 1.06869E-03
        g6 = -1.06133E-01
        g7 = -2.00286E-03
        g8 = 1.90251E-02
        g9 = 2.38305E-04
        g10 = 3.02210E-03
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -0.5<= Y <= 3.0 and  1.70 < Z <= 2.35:
        g1 = 3.43846E-02       
        g2 = -2.33584E-01
        g3 = 2.85574
        g4 = 2.59789E-01
        g5 = -10.89927E-03
        g6 = -1.94785
        g7 = 4.23659E-03
        g8 = -6.73865E-02
        g9 = 3.85712E-04
        g10 = 4.08518E-01
        g11 = -4.20569
        g12 = 1.33139E-01
        g13 = 4.51236
        g14 = -1.66341E-01
        g15 = 1.67787E-03
        g16 = -1.35516
        g17 = -1.10022E-03
        g18 = 4.91716E-02
        g19 = 3.06676E-04
        g20 = 7.52509E-02
        g21 = 1.757042E02
        g22 = -2.163278
        g23 = -8.833702E01
        g24 = 1.897543E00
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    elif -0.5<= Y <= 3.0 and  2.35 < Z:
        g1 = -1.70633
        g2 = -1.48403E-01  
        g3 = 4.23104E00
        g4 = 1.37290E-01
        g5 = -9.10934E-03
        g6 = -1.97292
        g7 = 3.85707E-03
        g8 = -2.81830E-02
        g9 = 2.69026E-04
        g10 = 2.95882E-01
        g11 = 3.41580E01
        g12 = -1.89972E01
        g13 = -4.0858E01
        g14 = 1.30321E01
        g15 = -8.0127E-01
        g16 = 1.60826E01
        g17 = 2.75121E-01
        g18 = -2.23386
        g19 = -1.77969E-04
        g20 = -2.08853
        g21 = 2.561323E02
        g22 = 1.737089E02
        g23 = -9.05889E01
        g24 = -5.838803
        pt = pt+1
        B = (1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ))
    A = round(g11 + g12*Y + g13*Z + g14*Y*Z + g15*Y**2 + g16*Z**2 + g17*Y**2*Z + g18*Y*Z**2 + g19*Y**3 + g20*Z**3,4)
    ans = g1 + g2*Y + g3*Z + g4*Y*Z + g5*Y**2 + g6*Z**2 + g7*Y**2*Z + g8*Y*Z**2 + g9*Y**3 + g10*Z**3 + (A/B)
    return e*rho*(ans -1)
    
#Internal Energy e as a function of pressure and entropy
def e_ps(p,s,p0,T0,e0,s0):
    X = np.log10(p/p0)
    Y = np.log10(s/R)
    Z = X - Y
    pt = 0
    if 1.23 <= Y <= 1.40:
        g1 = 4.89511E01        
        g2 = -1.15989E02         
        g3 = -4.43026E-01         
        g4 = 1.49819
        g5 = 8.70709E01
        g6 = -5.09747E-02
        g7 = -7.02417E-01
        g8 = 2.94929E-02
        g9 = -2.04916E01
        g10 = 5.24685E-04
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        g25 = 0
        pt = pt+1
    elif 1.40 < Y < 1.592:
        g1 = 1.30563E02        
        g2 = -2.87254E02         
        g3 = -7.71873E00         
        g4 = 1.17605E01
        g5 = 2.06757E02
        g6 = 1.64299E-01
        g7 = -4.31838E00
        g8 = -1.21768E-01
        g9 = -4.83472E01
        g10 = -1.26118E-03
        g11 = -8.4598E01
        g12 = 1.74701E02
        g13 = 9.52234
        g14 = -1.32819E01
        g15 = -1.20234E02
        g16 = -2.27725E-01
        g17 = 4.6271E00
        g18 = 1.60365E-01
        g19 = 2.75818E01
        g20 = 1.4933E-03
        g21 = -8.12685E02
        g22 = 1.304205E03
        g23 = 0
        g24 = -1.5E01
        g25 = -5.03745E02
        pt = pt+1
    elif 1.592 <= Y < 1.70 and  Z <= -1.917E00*Y + 0.092:
        g1 = -1.34875E02        
        g2 = 1.92654E02         
        g3 = 1.04478E01         
        g4 = -6.60355
        g5 = -6.72013E01
        g6 = 4.14546E-01
        g7 = 0
        g8 = -2.75698E-01
        g9 = 0
        g10 = 0
        g11 = 1.07768E02
        g12 = -1.61662E02
        g13 = -1.01257E01
        g14 = 6.4962
        g15 = 5.93194E01
        g16 = -4.63204E-01
        g17 = 0
        g18 = 3.04448E-01
        g19 = 0
        g20 = 0
        g21 = 1.49396E02
        g22 = -1.0008E02
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 1.592 <= Y < 1.70 and  Z > -1.917E00*Y + 0.092:
        g1 = 3.39933E01        
        g2 = 4.02792E01         
        g3 = 7.62742E-01         
        g4 = -3.79044E-01
        g5 = -1.09895E01
        g6 = -7.13421E-02
        g7 = 0
        g8 = 4.22359E-02
        g9 = 0
        g10 = 0
        g11 = 3.32182E01
        g12 = -4.03947E01
        g13 = 1.87601E-01
        g14 = -1.07599E-01
        g15 = 1.22657E01
        g16 = -1.65537E-01
        g17 = 0
        g18 = 1.02560E-01
        g19 = 0
        g20 = 0
        g21 = 4.8092E01
        g22 = -2.8124E01
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 1.70 <= Y < 1.80 and  Z <= -1.917E00*Y + 0.092:
        g1 = -1.66572E01        
        g2 = 1.51243E01        
        g3 = -4.72897E-01         
        g4 = 2.95848E-01
        g5 = -2.31418E00
        g6 = -3.61191E-02
        g7 = 0
        g8 = 1.7288E-02
        g9 = 0
        g10 = 0
        g11 = -3.27168E00
        g12 = 9.45383E00
        g13 = 2.04E00
        g14 = -1.1342E00
        g15 = -4.28765E00
        g16 = 1.5021E-01
        g17 = 0
        g18 = -8.27388E-02
        g19 = 0
        g20 = 0
        g21 = 4.6708E01
        g22 = -3.399E01
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 1.70 <= Y < 1.80 and  Z > -1.917E00*Y + 0.092:
        g1 = 1.94882E01        
        g2 = 2.31472E01        
        g3 = 1.00783E00         
        g4 = -5.18103E-01
        g5 = -5.92829E00
        g6 = 9.92242E-02
        g7 = 0
        g8 = -5.67928E-02
        g9 = 0
        g10 = 0
        g11 = -2.09813E00
        g12 = 1.22781E00
        g13 = -6.27531E-01
        g14 = 3.71651E-01
        g15 = 9.84125E-04
        g16 = -1.24024E-01
        g17 = 0
        g18 = 7.65034E-02
        g19 = 0
        g20 = 0
        g21 = 6.2192E01
        g22 = -3.6304E01
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 1.80 <= Y < 1.90 :
        g1 = -6.37715E01        
        g2 = 5.46005E01        
        g3 = -8.90073E00         
        g4 = 5.02063E00
        g5 = -9.67094E00
        g6 = -7.13493E-01
        g7 = 0
        g8 = 3.97962E-01
        g9 = 0
        g10 = 0
        g11 = 5.05131E01
        g12 = -3.97363E01
        g13 = 9.27248E00
        g14 =-5.15576E00
        g15 = 6.45632
        g16 = 7.2563E-01
        g17 = 0
        g18 = -4.03054E-01
        g19 = 0
        g20 = 0
        g21 = 1.17248E02
        g22 = -7.055E01
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 1.90 <= Y < 2.00 :
        g1 = -1.75434E01        
        g2 = 2.00307E01       
        g3 = 6.20484E-01         
        g4 = -2.76756E-01
        g5 = -4.76084E00
        g6 = 1.14921E-02
        g7 = 0
        g8 = -5.80043E-03
        g9 = 0
        g10 = 0
        g11 = 1.10485E01
        g12 = -1.261E01
        g13 = -6.590432E-01
        g14 = 3.66266E-01
        g15 = 3.59417E00
        g16 = -6.04061E-03
        g17 = 0
        g18 = 6.78382E-03
        g19 = 0
        g20 = 0
        g21 = 7.308E01
        g22 = -4.1768E01
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 2.00 <= Y < 2.10 :
        g1 = -1.18487E01        
        g2 = 1.26558E01      
        g3 = 6.09885E-04         
        g4 = 5.90396E-02
        g5 = -2.45275E00
        g6 = -6.70888E-03
        g7 = 0
        g8 = 5.21033E-03
        g9 = 0
        g10 = 0
        g11 = 3.39157E00
        g12 = -3.835
        g13 = -2.14031E-01
        g14 = 9.90508E-02
        g15 = 1.07008
        g16 = -7.87516E-02
        g17 = 0
        g18 = 3.63642E-02
        g19 = 0
        g20 = 0
        g21 = 2.65925E02
        g22 = -1.4142E02
        g23 = -5
        g24 = 0
        g25 = 0
        pt = pt+1
    elif 2.10 <= Y :
        g1 = -2.40636E01        
        g2 = 3.35589E00     
        g3 = -1.14521E01         
        g4 = 5.62572E00
        g5 = 4.93842E00
        g6 = -7.55608E-01
        g7 = 0
        g8 = 3.69774E-01
        g9 = 0
        g10 = 0
        g11 = 2.23905E01
        g12 = -1.90842E00
        g13 = 1.05618E01
        g14 = -5.17247
        g15 = -4.3714
        g16 = 6.27818E-01
        g17 = 0
        g18 = -3.12015E-01
        g19 = 0
        g20 = 0
        g21 = 5.2614E01
        g22 = -3.0096E01
        g23 = -2
        g24 = 0
        g25 = 0
        pt = pt+1
    
    if pt == 0 :
        return 2.5*e0*np.exp(((np.log(p/p0) + R*(s-s0))/3.5))
        
    A = round(g11 + g12*Y + g13*Z + g14*Y*Z + g15*Y**2 + g16*Z**2 + g17*Y**2*Z + g18*Y*Z**2 + g19*Y**3 + g20*Z**3,4)
    B = round(1 + np.exp(g21 + g22*Y + g23*Z + g24*X + g25*Y**2),5)
    ans = g1 + g2*Y + g3*Z + g4*Y*Z + g5*Y**2 + g6*Z**2 + g7*Y**2*Z + g8*Y*Z**2 + g9*Y**3 + g10*Z**3 + (A/B)
    return R*T0*10**ans
    
#Enthalpy as a function of Pressure and Density
def h_prho(p,rho,p0,rho0):
    X = np.log10(p/p0)
    Y = round(np.log10((rho)/(rho0)),4)
    Z = X - Y
    
    if -7 <= Y <= -4.5:
        if Z<=0.1 :
            c1 = 1.3986      
            c2 = 0       
            c3 = 0      
            c4 = 0
            c5 = 0
            c6 = 0
            c7 = 0
            c8 = 0
            c9 = 0
            c10 = 0
            c11 = 0
            c12 = 0
            c13 = 0
            c14 = 0
            c15 = 0
            c16 = 0
            c17 = 0
            c18 = 0
            c19 = 0
            c20 = 0
            c21 = 0
            c22 = 0
            c23 = 0
            c24 = 0
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
             
        elif 0.1 < Z <= 0.85:
            c1 = 2.53908E02        
            c2 = 1.01491E02        
            c3 = -3.87199E02        
            c4 = -1.54304E02
            c5 = 7.28532E00
            c6 = 9.86233E01
            c7 = -8.04378
            c8 = 4.63763E01
            c9 = -1.82577E-03
            c10 = 2.18994E01
            c11 = -2.52423E02
            c12 = -1.01445E02
            c13 = 3.87210E02
            c14 = 1.54298E02
            c15 = -7.2773E00
            c16 = -9.87576E01
            c17 = 8.04277E00
            c18 = -4.63883E01
            c19 = 2.28399E-03
            c20 = -2.19438E01
            c21 = -11
            c22 = 2
            c23 = 11
            c24 = -2
            c25 = -np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
        elif 0.85 < Z <= 1.30:
            c1 = -1.05745E01 
            c2 = -1.93693E00        
            c3 = 3.07202E01        
            c4 = 3.35578E00
            c5 = -7.79965E-02
            c6 = -2.60637E01
            c7 = 6.68790E-02
            c8 = -1.42391E00
            c9 = -9.86882E-04
            c10 = 7.23223
            c11 = -1.86342E01
            c12 = 2.41997E-02
            c13 = 3.20880E01
            c14 = -7.46914E-01
            c15 = 3.75161E-02
            c16 = -1.69985E01
            c17 = -4.10125E-02
            c18 = 5.39041E-01
            c19 = 5.74637E-04
            c20 = 2.56253
            c21 = 2.768567E02
            c22 = 2.15283E01
            c23 = -2.164837E02 
            c24 = -1.394837E01
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
    
    
        elif 1.3 <= Z < 1.95 :
            c1 = 6.17584E-01        
            c2 = -2.40690E-01        
            c3 = 1.95904E00        
            c4 = 3.41644E-01
            c5 = -1.01073E-02
            c6 = -1.68951E00
            c7 = 6.77631E-03
            c8 = -1.10932E-01
            c9 = -1.15922E-04
            c10 = 4.26058E-01
            c11 = -1.34222E01
            c12 = -5.43713E-01
            c13 = 1.81528E01
            c14 = 3.95928E-01
            c15 = -7.41105E-03
            c16 = -7.97425E00
            c17 = 1.67768E-03
            c18 = -5.80539E-02
            c19 = -3.32714E-06
            c20 = 1.12448
            c21 = 8.677803E01
            c22 = -8.370349E00
            c23 = -4.07084E01
            c24 = 7.4074084E00
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
        
        elif 1.95 < Z:
            c1 = -8.32959E00        
            c2 = -3.50219E-01        
            c3 = 1.36455E01        
            c4 = 3.5935E-01
            c5 = -3.70109E-03
            c6 = -6.49007
            c7 = 3.30836E-03
            c8 = -8.38594E-02
            c9 = 1.10018E-04
            c10 = 1.02443
            c11 = -3.08441E01
            c12 = -1.45910E00
            c13 = 3.00585E01
            c14 = 9.1965E-01
            c15 = -3.60024E-02
            c16 = -9.33522
            c17 = 1.02522E-02
            c18 = -1.35228E-01
            c19 = -4.68760E-04
            c20 = 8.92634E-01
            c21 = 8.800047E01
            c22 = -1.679356E01
            c23 = -3.333353E01
            c24 = 8.465574
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
        
        
    if -4.5 < Y <= -0.5:
        if Z<=0.1 :
            c1 = 1.399      
            c2 = 0       
            c3 = 0      
            c4 = 0
            c5 = 0
            c6 = 0
            c7 = 0
            c8 = 0
            c9 = 0
            c10 = 0
            c11 = 0
            c12 = 0
            c13 = 0
            c14 = 0
            c15 = 0
            c16 = 0
            c17 = 0
            c18 = 0
            c19 = 0
            c20 = 0
            c21 = 0
            c22 = 0
            c23 = 0
            c24 = 0
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
        elif 0.1 < Z <= 0.95 :
            c1 = -1.33083E02      
            c2 = -9.98707E00
            c3 = 3.94734E02  
            c4 = 2.35810E01
            c5 = 1.43957
            c6 = -3.84712E02
            c7 = -1.43175E00
            c8 = -1.36367E01
            c9 = 1.77068E-05
            c10 = 1.24325E02
            c11 = 1.34486E02
            c12 = 9.99122
            c13 = -3.94719E02
            c14 = -2.35853E01
            c15 = -1.43799
            c16 = 3.84616E02
            c17 = 1.43039E00
            c18 = 1.36318E01
            c19 = 1.44367E-04
            c20 = -1.24348E02
            c21 = -2.141444E01
            c22 = 1.381584E00
            c23 = 2.039473E01
            c24 = -1.315789
            c25 = -np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
        
        elif 0.95< Z <= 1.5 :
            c1 = -7.36684     
            c2 = -1.13247      
            c3 = 2.47879E01     
            c4 = 1.99625
            c5 = -4.9163E-02
            c6 = -2.3299E01
            c7 = 4.16673E-02
            c8 = -8.59418E-01
            c9 = -6.58149E-04
            c10 = 7.19016E00
            c11 = -2.42647
            c12 = 5.57912E-01
            c13 = -2.03055E00
            c14 = -1.22031
            c15 = 3.74866E-02
            c16 = 7.75414E00
            c17 = -3.39278E-02
            c18 = 6.08488E-01
            c19 = 5.21042E-04
            c20 = -3.68326
            c21 = 8.077385E01
            c22 = -1.273807E01
            c23 = -6.547623E01
            c24 = 1.190475E01
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
        elif 1.5< Z <= 2 :
            c1 = 4.3152E-01   
            c2 = -2.83857E-01      
            c3 = 2.27791
            c4 = 3.99159E-01
            c5 = -1.29444E-02
            c6 = -1.84314
            c7 = 8.78724E-03
            c8 = -1.28136E-01
            c9 = -1.60583E-04
            c10 = 4.45362E-01
            c11 = -1.03883E01
            c12 = -3.58718E-01
            c13 = 1.35068E01
            c14 = 1.87268E-01
            c15 = -4.28184E-03
            c16 = -5.63894
            c17 = -9.52016E-04
            c18 = -1.45625E-03
            c19 = -4.10506E-05
            c20 = 7.39915E-01
            c21 = 2.949221E02
            c22 = 1.36866E01
            c23 = -1.559335E02
            c24 = -3.78776
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
   
    
        elif 2 < Z :
            c1 = -3.77766     
            c2 = -5.53738E-01
            c3 = 6.60834
            c4 = 4.87181E-01
            c5 = -2.11045E-02
            c6 = -2.94754E00
            c7 = 9.67277E-03
            c8 = -1.02365E-01
            c9 = -2.1942E-04
            c10 = 4.3962E-01
            c11 = 4.05813E01
            c12 = 3.25692
            c13 = -4.79583E01
            c14 = -2.53660
            c15 = 9.06436E-02
            c16 = 1.8904E01
            c17 = -3.47578E-02
            c18 = 4.94114E-01
            c19 = 1.00077E-03
            c20 = -2.48554E00
            c21 = 5.34718E02
            c22 = 7.495657E01
            c23 = -2.219822E02
            c24 = -3.017229E01
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
    
    if -0.5 < Y <= 3:
        if Z<= 0.1 :
            c1 = 1.4017     
            c2 = 0       
            c3 = 0      
            c4 = 0
            c5 = 0
            c6 = 0
            c7 = 0
            c8 = 0
            c9 = 0
            c10 = 0
            c11 = 0
            c12 = 0
            c13 = 0
            c14 = 0
            c15 = 0
            c16 = 0
            c17 = 0
            c18 = 0
            c19 = 0
            c20 = 0
            c21 = 0
            c22 = 0
            c23 = 0
            c24 = 0
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
        elif 0.1< Z <= 1.05 :
            c1 = -9.67488E01        
            c2 = 2.05296E-01        
            c3 = 2.69927E02        
            c4 = -1.922887E00
            c5 = 3.78392E-01
            c6 = -2.46711E02
            c7 = -3.24965E-01
            c8 = 1.54416E00
            c9 = -3.61036E-03
            c10 = 7.48760E01
            c11 = 9.81502E01
            c12 = -2.05448E-01
            c13 = -2.69913E02
            c14 = 1.93052E00
            c15 = -3.78527E-01
            c16 = 2.46630E02
            c17 = 3.24832E-01
            c18 = -1.54646E00
            c19 = 3.66182E-03
            c20 = -7.4898E01
            c21 = -2.659865E01
            c22 = 1.564631E00
            c23 = 2.312926E01
            c24 = -1.360543E00
            c25 = -np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
        elif 1.05 < Z <= 1.6 :
            c1 = -2.67593E-01   
            c2 = -1.87457E-01
            c3 = 5.07693E00
            c4 = 2.72286E-01
            c5 = 1.04541E-02
            c6 = -5.0852
            c7 = -1.42211E-02
            c8 = -7.81935E-02
            c9 = 6.38962E-04
            c10 = 1.58711
            c11 = 2.87969
            c12 = 3.9009E-01
            c13 = -8.06179
            c14 = -5.5125E-01
            c15 = -1.01903E-02
            c16 = 7.29592
            c17 = 1.35906E-02
            c18 = 1.83861E-01
            c19 = -8.97772E-04
            c20 = -2.15153E00
            c21 = 1.828573E02
            c22 = -3.428596E01
            c23 = -1.51786E02
            c24 = 2.976212E01
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)
            
            
        elif 1.6 < Z :
            c1 = 9.21537E-01  
            c2 = -2.39670E-01
            c3 = 1.30714
            c4 = 3.4299E-01
            c5 = -2.18847E-02
            c6 = -1.20916
            c7 = 1.36691E-02
            c8 = -1.10206E-01
            c9 = -4.90274E-04
            c10 = 3.08792E-01
            c11 = -6.77089
            c12 = -6.90476E-02
            c13 = 8.18168
            c14 = -9.52708E-02
            c15 = 2.98487E-02
            c16 = -3.07662
            c17 = -1.78706E-02
            c18 = 6.60408E-02
            c19 = 6.28419E-04
            c20 = 3.3859E-01
            c21 = 1.5916669E02
            c22 = 3.976192E01
            c23 = -7.966199E01
            c24 = -1.66667E01 
            c25 = np.exp(c21+ c22*Y +c23*Z + c24*Z*Y)    
            
    A = c11 + c12*Y + c13*Z + c14*Y*Z + c15*Y**2 + c16*Z**2 + c17*Y**2*Z + c18*Y*Z**2 + c19*Y**3 + c20*Z**3
    ans = c1 + c2*Y + c3*Z + c4*Y*Z + c5*Y**2 + c6*Z**2 + c7*Y**2*Z + c8*Y*Z**2 + c9*Y**3 + c10*Z**3 + A/(1+c25)
    return (p/rho)*(ans/(ans-1))

#Speed of sound as a function of Pressure and Entropy
def a_ps(p,s,p0,a0):
    X = np.log10(p/p0)
    Y = np.log10(s/R)
    Z = X - Y
    pt = 0
    if 1.23 <= Y <= 1.4:
        h1 = -1.38377E-01      
        h2 = -8.84138
        h3 = 2.6105
        h4 = 3.16535
        h5 = 1.10866E01
        h6 = -1.00224E-01
        h7 = 9.88389E-01
        h8 = 6.62193E-02
        h9 = -3.25761
        h10 = 8.20610E-04
        h11 = 0
        h12 = 0
        h13 = 0
        h14 = 0
        h15 = 0
        h16 = 0
        h17 = 0
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 0
        h22 = 0
        h23 = 0
        h24 = 0
        h25 = 0
        pt = pt+1
       
       
    elif 1.4 < Y <= 1.595:
        h1 = 1.31057E02    
        h2 = -2.88847E02
        h3 = -5.04887
        h4 = 7.73862
        h5 = 2.10147E02
        h6 = 5.438031E-02
        h7 = -2.88963
        h8 = -4.39459E-02
        h9 = -5.0396E01
        h10 = -2.10202E-04
        h11 = -1.33456E02
        h12 = 2.84739E02
        h13 = 7.57389
        h14 = -1.07749E01
        h15 = -2.02362E02
        h16 = 1.53453E-01
        h17 = 3.8313
        h18 = 1.08531E-01
        h19 = 4.79075E01
        h20 = 9.7931E-04
        h21 = 8.12685E02
        h22 = 1.304205E03
        h23 = 0
        h24 = -1.5E01
        h25 = -5.03745E02
        pt = pt+1
       
       
    elif 1.595 < Y <= 1.693 and Z<= -9.842*Y + 14.19 :
        h1 = -6.13548E01    
        h2 = 7.80742E01
        h3 = 2.08524
        h4 = -1.21609
        h5 = -2.43686E01
        h6 = 8.77563E-02
        h7 = 0
        h8 = -5.46311E-02
        h9 = 0
        h10 = 0
        h11 = 2.07952E01
        h12 = -2.71591E01
        h13 = -7.43673E-01
        h14 = 4.08312E-01
        h15 = 8.68124
        h16 = -9.3592E-02
        h17 = 0
        h18 = 5.32328E-02
        h19 = 0
        h20 = 0
        h21 = 1.14314E02
        h22 = -7.757E01
        h23 = -2
        h24 = 0
        h25 = 0
        pt = pt+1
           
    elif 1.595 < Y <= 1.693 and Z> -9.842*Y + 14.19 :
        h1 = 3.37056    
        h2 = -4.87016
        h3 = -3.85754E-01
        h4 = 2.87192E-01
        h5 = 2.02041
        h6 = -4.63144E-03
        h7 = 0
        h8 = 8.30832E-03
        h9 = 0
        h10 = 0
        h11 = 0
        h12 = 0
        h13 = 0
        h14 = 0
        h15 = 0
        h16 = 0
        h17 = 0
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 0
        h22 = 0
        h23 = 0
        h24 = 0
        h25 = 0
        pt = pt+1
       
    elif 1.693 <= Y < 1.80 and Z<= -1.917*Y + 0.092 :
        h1 = -8.04927E01  
        h2 = 7.63739E01
        h3 = -9.381
        h4 = 5.72104
        h5 = -1.63435E01
        h6 = 7.48578E-01
        h7 = 0
        h8 = 4.50043E-01
        h9 = 0
        h10 = 0
        h11 = 8.34054E01
        h12 = -8.58837E01
        h13 = 4.84197
        h14 = -3.11188
        h15 = 2.11196E01
        h16 = 2.33945E-01
        h17 = 0
        h18 = -1.59099E-01
        h19 = 0
        h20 = 0
        h21 = 1.5138E01
        h22 = -1.5748E01
        h23 = -2
        h24 = 0
        h25 = 0
        pt = pt+1
        
    elif 1.693 <= Y < 1.80 and Z > -1.917*Y + 0.092 :
        h1 = -4.73308E00  
        h2 = 4.69363E00
        h3 = 9.43798E-02
        h4 = 3.54953E-03
        h5 = -7.98293E-01
        h6 = 2.02561E-02
        h7 = 0
        h8 = -8.73038E-03
        h9 = 0
        h10 = 0
        h11 = 0
        h12 = 0
        h13 = 0
        h14 = 0
        h15 = 0
        h16 = 0
        h17 = 0
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 0
        h22 = 0
        h23 = 0
        h24 = 0
        h25 = 0
        pt = pt+1
    
    elif 1.80 <= Y < 1.90:
        h1 = -6.60574E02  
        h2 = 7.38042E02
        h3 = -8.77589E01
        h4 = 9.7894E01
        h5 = -2.06156E02
        h6 = -2.14028E-02
        h7 = -2.73753E01
        h8 = 0
        h9 = 0
        h10 = 0
        h11 = 6.65014E02
        h12 = -7.43416E02
        h13 = 8.87679E01
        h14 = 9.90508E01
        h15 = 2.08117E02
        h16 = 2.81148E-02
        h17 = 2.77374E01
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 1.17248E02
        h22 = 7.055E01
        h23 = -2.0E00
        h24 = 0
        h25 = 0
        pt = pt+1
        
    elif 1.90 <= Y < 2.00:
        h1 = -5.93554E00 
        h2 = -7.79929
        h3 = -7.23618
        h4 = 3.31162
        h5 = 5.06381
        h6 = -5.377735E-01
        h7 = 0
        h8 = 2.46865E-01
        h9 = 0
        h10 = 0
        h11 = 3.9526E01
        h12 = -2.90994E01
        h13 = 6.24136E00
        h14 = -2.70007E00
        h15 = 5.42786
        h16 = 5.95235E-01
        h17 = 0
        h18 = -2.67771E-01
        h19 = 0
        h20 = 0
        h21 = 4.0352E01
        h22 = 2.73502E01
        h23 = -2
        h24 = 0
        h25 = 0
        pt = pt+1
        
    elif 2.00 <= Y < 2.10:
        h1 = 7.02453E01
        h2 = -7.34732E01
        h3 = 5.86844E-01
        h4 = 0
        h5 = 1.95548E01
        h6 = 7.36786E-03
        h7 = 1.81521E-01
        h8 = 0
        h9 = 0
        h10 = 0
        h11 = -1.6961E01
        h12 = 1.80169E01
        h13 = -3.65779E-01
        h14 = 0
        h15 = -4.75063
        h16 = 2.01803E-02
        h17 = 1.07583E-01
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 2.6592E02
        h22 = -1.4142E02
        h23 = -5
        h24 = 0
        h25 = 0
        pt = pt+1
        
    elif 2.10<= Y:
        h1 = 1.12793E02  
        h2 = 1.35296E02
        h3 = 2.74295E00
        h4 = 0
        h5 = -4.08171E01
        h6 = -2.25652E-01
        h7 = -1.29257E00
        h8 = 0
        h9 = 0
        h10 = 0
        h11 = 2.57057E02
        h12 = 2.83199E02
        h13 = -5.84656E00
        h14 = 0
        h15 = 7.91574E01
        h16 = 3.35658E-01
        h17 = 2.17312
        h18 = 0
        h19 = 0
        h20 = 0
        h21 = 5.2614E01
        h22 = 3.0096E01
        h23 = -2.0
        h24 = 0
        h25 = 0
        pt = pt+1
    
    if pt == 0:
        return np.sqrt(np.exp(np.log(1.4*p0/rho0) + (np.log(p/p0) + (s-s0)/R)/3.5)) 
    
    A = h11 + h12*Y + h13*Z + h14*Y*Z + h15*Y**2 + h16*Z**2 + h17*Y**2*Z + h18*Y*Z**2 + h19*Y**3 + h20*Z**3
    B = 1 + np.exp(h21 + h22*Y + h23*Z + h24*X + h25*Y**2)
    ans = h1 + h2*Y + h3*Z + h4*Y*Z + h5*Y**2 + h6*Z**2 + h7*Y**2*Z + h8*Y*Z**2 + h9*Y**3 + h10*Z**3 + (A/B)
          
    return a0*10**ans  

#Entropy as a function of internal energy and density
#function to obtain difference between a given value of entropy and that obtained from the function
def s_erho(e,rho,rho0,T0,s_true):
    Y = round(np.log10(rho/rho0),4)
    Z = np.log10(e/(R*T0))
    s = 0
    if Z <= 0.65 and -7 <= Y <= -4.5:
        e1 = -9.91081E-01
        e2 = -5.00277
        e3 = 5.46521E01
        e4 = 5.10144
        e5 = 1.76206E-02
        e6 = -2.97001E01
        e7 = 2.12002E-02
        e8 = -1.84915E00
        e9 = 1.76358E-03
        e10 = 5.87892
        s = R*(e1 + e2*Y + e3*Z + e4*Y*Z + e5*Y**2 + e6*Z**2 + e7*Y**2*Z + e8*Y*Z**2 + e9*Y**3 + e10*Z**3)        
    if Z <= 0.65 and -4.5 < Y <= 0.5:
        e1 = 1.0836E01
        e2 = -4.55524
        e3 = 2.96473E01
        e4 = 3.90851E00
        e5 = -2.05732E-03
        e6 = -1.67001E01
        e7 = 3.65982E-02
        e8 = -1.44623E00
        e9 = 5.23821E-03
        e10 = 3.98307E00    
        s = R*(e1 + e2*Y + e3*Z + e4*Y*Z + e5*Y**2 + e6*Z**2 + e7*Y**2*Z + e8*Y*Z**2 + e9*Y**3 + e10*Z**3)
    if Z <= 0.65 and 0.5 < Y <= 3.0:
        e1 = 2.01858E01
        e2 = -3.13458
        e3 = 1.03619E01
        e4 = 1.87767E00
        e5 = -1.72922E-01
        e6 = -5.43557E00
        e7 = 1.12174E-01
        e8 = -8.71048E-01
        e9 = 1.28626E-02
        e10 = 2.01789
        s = R*(e1 + e2*Y + e3*Z + e4*Y*Z + e5*Y**2 + e6*Z**2 + e7*Y**2*Z + e8*Y*Z**2 + e9*Y**3 + e10*Z**3)   
    if s == 0 :
        s = 6779.2004 + (2.5*(Z-0.4) - Y)*(2.302585*R)
    return s - s_true

#Another function similar to the previous one but to obtain the value of entropy
def reals_erho(e,rho,rho0,T0):
    Y = np.log10(rho/rho0)
    Z = np.log10(e/(R*T0))
    s = 0
    if Z <= 0.65 and -7 <= Y <= -4.5:
        e1 = -9.91081E-01
        e2 = -5.00277
        e3 = 5.46521E01
        e4 = 5.10144
        e5 = 1.76206E-02
        e6 = -2.97001E01
        e7 = 2.12002E-02
        e8 = -1.84915E00
        e9 = 1.76358E-03
        e10 = 5.87892
        s = R*(e1 + e2*Y + e3*Z + e4*Y*Z + e5*Y**2 + e6*Z**2 + e7*Y**2*Z + e8*Y*Z**2 + e9*Y**3 + e10*Z**3)
    elif Z <= 0.65 and -4.5 < Y <= 0.5:
        e1 = 1.0836E01
        e2 = -4.55524
        e3 = 2.96473E01
        e4 = 3.90851E00
        e5 = -2.05732E-03
        e6 = -1.67001E01
        e7 = 3.65982E-02
        e8 = -1.44623E00
        e9 = 5.23821E-03
        e10 = 3.98307E00
        s = R*(e1 + e2*Y + e3*Z + e4*Y*Z + e5*Y**2 + e6*Z**2 + e7*Y**2*Z + e8*Y*Z**2 + e9*Y**3 + e10*Z**3)
    elif Z <= 0.65 and 0.5 < Y <= 3.0:
        e1 = 2.01858E01
        e2 = -3.13458
        e3 = 1.03619E01
        e4 = 1.87767E00
        e5 = -1.72922E-01
        e6 = -5.43557E00
        e7 = 1.12174E-01
        e8 = -8.71048E-01
        e9 = 1.28626E-02
        e10 = 2.01789
        s = R*(e1 + e2*Y + e3*Z + e4*Y*Z + e5*Y**2 + e6*Z**2 + e7*Y**2*Z + e8*Y*Z**2 + e9*Y**3 + e10*Z**3)
    if s == 0:
        s = 6779.2004 + (2.5*(Z-0.4) - Y)*(2.302585*R)
    return s 

#defining reference conditions 
p0 = 1.032*10**5 #reference pressure
T0 = 273.15      # reference temperature
rho0 = 1.2       #reference density
a0 = np.sqrt(1.4*R*T0) #reference speed of sound
e0 = 215000      #reference internal energy obtained from functional evaluations
s0 = reals_erho(e0,rho0,rho0,T0) #reference entropy





'''
#Temperature as a function of internal energy e and density
def T_erho(e,rho,T0,rho0):
    X = np.log10(p/p0)
    Y = np.log10(rho/rho0)
    Z = X - Y
    pt = 0
    if -7 <= Y <= -4.5 and 0.25 < Z <= 0.95:
        g1 = 1.44824E-01       
        g2 = 1.36744E-02         
        g3 = 1.17099E-01         
        g4 = -8.22299E-02
        g5 = -6.75303E-04
        g6 = 1.3937
        g7 = -1.47314E-03
        g8 = 6.83066E-02
        g9 = -7.90851E-05
        g10 = -6.65673E-01
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
    elif -7 <= Y <= -4.5 and 0.95 < Z <= 1.40:
        g1 = -9.325E00
        g2 = -9.32017E-01         
        g3 = 2.57176E01        
        g4 = 1.61292E00
        g5 = -3.00242E-02
        g6 = -2.1662E01
        g7 = 2.62959E-02
        g8 = -6.81431E-01
        g9 = -2.77651E-04
        g10 = 6.26962E00
        g11 = -3.38534
        g12 = 1.82594E-01
        g13 = 1.84928E-01
        g14 = -7.01109E-01
        g15 = 1.10150E-02
        g16 = 5.4702
        g17 = -1.60570E-02
        g18 = 4.11624E-01
        g19 = 1.57701E-05
        g20 = -2.81498E00
        g21 = -3.887015E01
        g22 = -2.908228E01
        g23 = 4.070557E01
        g24 = 2.682347E01
        pt = pt+1
    elif -7 <= Y <= -4.5 and 1.40 < Z <= 1.95:
        g1 = -1.93082E01       
        g2 = -1.54557E00         
        g3 = 3.69035E01         
        g4 = 1.92214E00
        g5 = -3.59027E-02
        g6 = -2.20440E01
        g7 = 2.31827E-02
        g8 = -5.80935E-01
        g9 = -2.01327E-04
        g10 = 4.43367
        g11 = -3.83069
        g12 = 1.32864E-01
        g13 = -3.91902E00
        g14 = -6.79564E-01
        g15 = 6.06341E-04
        g16 = 7.24632E00
        g17 = -8.12997E-03
        g18 = 3.15461E-01
        g19 = 1.61012E-04
        g20 = -2.17879
        g21 = 2.08E01
        g22 = -2.56E01
        g23 = 1
        g24 = 1.8E01 
        pt = pt+1
    elif -7 <= Y <= -4.5 and 1.95 < Z:
       
        g1 = -2.59721E01
        g2 = -1.77419E00         
        g3 = 3.62495E01         
        g4 = 1.55383E00
        g5 = -4.51359E-02
        g6 = -1.59988E01
        g7 = 2.43648E-02
        g8 = -3.17807E-01
        g9 = 1.2804E-04
        g10 = 2.40584
        g11 = -1.81433E01
        g12 = 1.54896E-01
        g13 = 1.26582E01
        g14 = -3.66275E-01
        g15 = 3.24496E-02
        g16 = -1.41759E00
        g17 = -1.66385E-02
        g18 = 1.11241E-01
        g19 = 3.02177E-04
        g20 = -3.10983E-01
        g21 = 1.115884E02
        g22 = -6.452606
        g23 = -5.337863E01
        g24 = 2.026986
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 0.25 < Z <= 0.95:
        g1 = 2.94996E-02       
        g2 = 7.24997E-03         
        g3 = 7.81783E-01         
        g4 = -3.27402E-01
        g5 = 3.23357E-04
        g6 = 3.95198E-01
        g7 = -9.69989E-04
        g8 = 2.92926E-02
        g9 = -8.9324E-06
        g10 = -2.12182E-01
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 0.95 < Z <= 1.40:
        g1 = -5.53324E00       
        g2 = -3.53749E-01         
        g3 = 1.63638E01        
        g4 = 5.87547E-01
        g5 = -1.16081E-02
        g6 = -1.141239E01
        g7 = 7.99571E-03
        g8 = -2.35146E-01
        g9 = -2.79316E-04
        g10 = 4.28891E00
        g11 = 9.07979
        g12 = 1.01308
        g13 = -2.29428E01
        g14 = -1.52122
        g15 = 3.78390E-02
        g16 = 1.95657E01
        g17 = -2.63115E-02
        g18 = 5.73839E-01
        g19 = 5.46402E-04
        g20 = -5.63057
        g21 = 7.619803E01
        g22 = -1.501155E01
        g23 = -6.770845E01
        g24 = 1.273147E01
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 1.40 < Z <= 2.00:
        g1 = -1.13598E01
        g2 = -1.02049E00         
        g3 = 2.22793E01         
        g4 = 1.24039
        g5 = -3.10771E-02
        g6 = -1.31512E01
        g7 = 1.92551E-02
        g8 = -3.62875E-01
        g9 = -2.69140E-04
        g10 = 2.64544
        g11 = 8.72852E00
        g12 = 1.27564
        g13 = -1.79172E01
        g14 = -1.52051
        g15 = 4.91264E-02
        g16 = 1.16719E01
        g17 = -2.81731E-02
        g18 = 4.5413E-01
        g19 = 5.23383E-04
        g20 = -2.45584
        g21 = 1.84792E02
        g22 = 9.583443E00
        g23 = -1.020835E02
        g24 = -4.166727
        pt = pt+1
    elif -4.5 <= Y <= -0.5 and 2.00 < Z:
        g1 = -1.76079E01       
        g2 = -1.26579         
        g3 = 2.48544E01         
        g4 = 1.09442
        g5 = -3.65534E-02
        g6 = -1.08166E01
        g7 = 1.54346E-02
        g8 = -2.27803E-01
        g9 = -4.59822E-04
        g10 = 1.60641
        g11 = 2.60669E01
        g12 = 2.31791
        g13 = -3.22433E01
        g14 = -1.82645
        g15 = 4.94621E-02
        g16 = 1.33829E01
        g17 = -1.85542E-02
        g18 = 3.59744E-01
        g19 = 5.04815E-04
        g20 = -1.86517E00
        g21 = 3.093755E02
        g22 = 1.875018E01
        g23 = -1.375004E02
        g24 = -8.333418
        pt = pt+1
    elif -0.5 <= Y <= 3.0 and 0.25 < Z <= 0.95:
        g1 = -2.94081E-03       
        g2 = 5.73915E-04        
        g3 = 9.88883E-01         
        g4 =  -3.71241E-03
        g5 = 1.12387E-04
        g6 = 2.86656E-02
        g7 = -3.76528E-04
        g8 = 4.56059E-03
        g9 = 1.76192E-05
        g10 = -1.99498E-02
        g11 = 0
        g12 = 0
        g13 = 0
        g14 = 0
        g15 = 0
        g16 = 0
        g17 = 0
        g18 = 0
        g19 = 0
        g20 = 0
        g21 = 0
        g22 = 0
        g23 = 0
        g24 = 0 
        pt = pt+1
    elif -0.5 <= Y <= 3.0 and 0.95 < Z <= 1.45:
        g1 = 1.32396       
        g2 = 8.52771E-02        
        g3 = -3.24257         
        g4 = -2.00937E-01
        g5 = 5.68146E-03
        g6 = 4.53823
        g7 = -6.85856E-03
        g8 = 1.18123E-01
        g9 = 1.98366E-04
        g10 = -1.6246
        g11 = -5.26673E-01
        g12 = -1.58691E-01
        g13 = 2.61600
        g14 = 3.16356E-01
        g15 = -1.90755E-02
        g16 = -3.3793
        g17 = 1.70124E-02
        g18 = -1.52212E-01
        g19 = 5.58398E-04
        g20 = 1.30757
        g21 = 1.442206E02
        g22 = -2.544727E01
        g23 = -1.277055E02
        g24 = 2.236647E01
        pt = pt+1
    elif -0.5 <= Y <= 3.0 and 1.45 < Z:
        g1 = -1.60643E00
        g2 = -5.07368E-02        
        g3 = 3.95872E00        
        g4 =  3.69383E-02
        g5 = -1.59378E-03
        g6 = -1.71201E00
        g7 = 1.06057E-03
        g8 = 9.25124E-03
        g9 = 6.53278E-05
        g10 = 2.71039E-01
        g11 = 1.80476E01
        g12 = 1.62964
        g13 = -2.73124E01
        g14 = -1.57430
        g15 = 5.85277E-02
        g16 = 1.36342E01
        g17 = -2.77313E-02
        g18 = 3.70714E-01
        g19 = 1.16146E-03
        g20 = -2.23787
        g21 = 1.292515E02
        g22 = 1.360552
        g23 = -7.07482E01
        g24 = 1.360532
        pt = pt+1
    A = round(g11 + g12*Y + g13*Z + g14*Y*Z + g15*Y**2 + g16*Z**2 + g17*Y**2*Z + g18*Y*Z**2 + g19*Y**3 + g20*Z**3,4)
    B = round(1 + np.exp(g21 + g22*Y + g23*Z + g24*Y*Z ),5)
    ans = g1 + g2*Y + g3*Z + g4*Y*Z + g5*Y**2 + g6*Z**2 + g7*Y**2*Z + g8*Y*Z**2 + g9*Y**3 + g10*Z**3 + (A/B) 
    return ans
'''

